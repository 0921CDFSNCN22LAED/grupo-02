<!DOCTYPE html>
<html lang="es">

<head>
    <%- include("./partials/head") %>
</head>

<body>
    <header><%- include("./partials/header") %></header>
    <main id="profile" class="container-fluid">
        <!-- Modal Eliminar subPerfil -->
        <div class="modal fade" id="deleteSubUserModal" tabindex="-1" aria-labelledby="deleteSubUserModal"
            aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered ">
                <div class="modal-content bg-light">
                    <div class="modal-header">
                        <button type="button" class="btn-close button-right " aria-label="Close"
                            data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <h4>¿Está seguro que desea eliminar este perfil?</h4>
                        <button type="button" class="btn btn-primary button-right" data-bs-dismiss="modal">No,
                            volver atrás</button>
                        <button type="button" class="btn btn-danger button-right" data-bs-dismiss="modal">Si,
                            eliminar perfil</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="main">
            <section class="row z-index-1">
                <article class="col-12 col-md-6 cursos-main padding-10">
                    <div class="clases-main-container padding-10">
                        <h2>Tus datos personales</h2>
                        <form action="/user/<%= old.id %>/update?_method=PUT" method="post"
                            enctype="multipart/form-data" class="clases-main-item">
                            <fieldset disabled>

                                <div class="form-floating my-3">
                                    <input class="form-control disabled" type="text" name="userName" id="userName"
                                        placeholder="Nombre de usuario"
                                        <% if(locals.old && old.userName){ %>value="<%=old.userName%>" <%} %> />
                                    <label for="userName">Nombre de usuario</label>
                                </div>
                                <div class="form-floating my-3">
                                    <input class="form-control disabled" type="text" name="userEmail" id="userEmail"
                                        placeholder="Correo electrónico"
                                        <% if(locals.old && old.userEmail){ %>value="<%=old.userEmail%>" <%} %> />
                                    <label for="userEmail">Correo electrónico</label>
                                </div>

                            </fieldset>
                            <% if(locals.old && old.avatar) { %>
                            <div class="d-flex my-3">
                                <img class="img-thumbnail w-50 me-5 rounded-circle"
                                    src="/img/avatars/<%= old.avatar %> " alt="avatar ya cargado">
                                <div class="form-upload">
                                    <label for="avatar" class="form-label">Cambiá tu avatar</label>
                                    <input class="form-control" type="file" id="avatar" placeholder="Cargá tu avatar"
                                        name="avatar" />
                                </div>
                            </div>
                            <% } else { %>
                            <div class="form-upload my-3">
                                <label for="avatar" class="form-label">Cargá tu avatar</label>
                                <input class="form-control" type="file" id="avatar" placeholder="Cargá tu avatar"
                                    name="avatar" />
                            </div>
                            <% } %>
                            <fieldset disabled="disabled">
                                <div class="form-floating my-3">
                                    <input class="form-control" type="password" name="userPassword" id="userPassword"
                                        placeholder="Contraseña" />
                                    <label class="text-shadow" for="userPassword">Cambiá tu contraseña</label>
                                </div>
                            </fieldset>
                            <button class="btn btn-primary btn-lg button-right" type="submit">Actualizar</button>
                            <button class="btn btn-warning btn-lg button-right" type="submit" formmethod="get"
                                formaction="/user/logout">Cerrar sesión</button>

                        </form>
                    </div>
                </article>
                <article class="col-12 col-md-6 cursos-main padding-10">
                    <div class="clases-main-container padding-10">
                        <h2>Progreso</h2>
                        <div class="clases-main-item">
                            <table class="table table-hover">
                                <tr>
                                    <th>Hijo</th>
                                    <th>Clase</th>
                                    <th>Progreso</th>
                                </tr>
                                <tr>
                                    <td>Hijo 1</td>
                                    <td>Clase 1</td>
                                    <td>Barra de progreso</td>
                                </tr>
                                <tr>
                                    <td>Hijo 2</td>
                                    <td>Clase 2</td>
                                    <td>Barra de progreso</td>
                                </tr>
                            </table>
                        </div>
                    </div>
                </article>
                <% let i = 1 %>
                <% for (; i <= 2; i++) {%>
                <article class="col-12 col-md-6 cursos-main padding-10">
                    <div class="clases-main-container padding-10">
                        <h2>
                            Datos de tu hijo
                            <!-- Button trigger modal -->
                            <button data-bs-toggle="modal" data-bs-target="#deleteSubUserModal"
                                class="btn-close button-right mt-0" aria-label="Close" data-bs-dismiss="modal"
                                type="submit"></button>
                        </h2>

                        <div class="clases-main-item">
                            <form action="/user/<%=old.id%>/updateChildren?_method=PUT" method="post"
                                enctype="multipart/form-data">
                                <input class="invisible" type="text" name="childId" value="<%=old.id + (i/10)%>">
                                <div class="form-floating my-3">
                                    <input class="form-control" type="text" name="name" id="name"
                                        placeholder="Nombre de usuario del hijo"
                                        <% if(locals.old.children && locals.old.children[old.id + (i/10)] && old.children[old.id + (i/10)].name){ %>value="<%=old.children[old.id + (i/10)].name%>"
                                        <%} %> />
                                    <label for="name">Nombre de usuario del hijo</label>
                                </div>
                                <% if(locals.old.children && locals.old.children[old.id + (i/10)] && old.children[old.id + (i/10)].avatar) { %>
                                <div class="d-flex my-3">
                                    <img class="img-thumbnail w-50 me-5 rounded-circle"
                                        src="/img/avatars/<%=old.children[old.id + (i/10)].avatar%>"
                                        alt="avatar ya cargado">
                                    <div class="form-upload my-3">
                                        <label for="avatar" class="form-label">Avatar del hijo</label>
                                        <input class="form-control" type="file" id="avatar"
                                            placeholder="Avatar del hijo" name="avatar" />
                                    </div>
                                </div>
                                <% } else { %>
                                <div class="form-upload my-3">
                                    <label for="avatar" class="form-label">Avatar del hijo</label>
                                    <input class="form-control" type="file" id="avatar" placeholder="Avatar del hijo"
                                        name="avatar" />
                                </div>
                                <% } %>

                                <button class="btn btn-primary btn-lg button-right" type="submit">Actualizar
                                    perfil</button>
                                <button class="btn btn-primary btn-lg button-right" type="submit"
                                    formaction="/user/userSelected/<%=old.id + (i/10)%>" formmethod="get">Ingresar como
                                    <%= old.children.name ?  old.children[old.id + (i/10)].name : "invitado"%></button>
                            </form>
                        </div>
                    </div>
                </article>
                <% } %>
                <% if(i < 5) { %>
                <article class="col-12 col-md-6 cursos-main padding-10">
                    <div class="clases-main-container padding-10">
                        <h2>Agregar hijo <i class="far fa-plus-square button-right mt-1"></i></h2>

                    </div>
                </article>
                <% } %>

            </section>
        </div>

    </main>
    <%- include("./partials/footer") %>
</body>

</html>